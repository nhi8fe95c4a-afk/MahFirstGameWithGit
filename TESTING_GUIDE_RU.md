# Тестирование и отладка сбора яблок (Apple Collection Testing)

## Изменения внесены

### 1. Исправлено расположение яблок ✓
- Все яблоки теперь находятся на расстоянии минимум 2 единицы друг от друга
- Яблоки распределены по всей игровой зоне (X: от -12 до 12, Y: от 2 до 10)

### 2. Добавлен эффект исчезновения ✓
- Яблоки теперь плавно исчезают (fade out) при сборе, изменяя альфа-канал от 1 до 0
- Время исчезновения: 0.5 секунды (настраивается в Inspector → fadeOutTime)

### 3. Добавлено логирование для отладки ✓
- Подробные сообщения в консоли Unity помогут определить, работает ли система столкновений

### 4. Настроен ScoreManager ✓
- Добавлено поле totalApples = 20
- Система будет показывать экран победы после сбора всех яблок

## Как протестировать в Unity Editor

### Шаг 1: Откройте проект
1. Откройте проект в Unity Editor (версия 6 или новее)
2. Откройте сцену: Assets/Scenes/SampleScene.unity

### Шаг 2: Проверьте консоль при запуске
1. Откройте окно Console (Window → General → Console)
2. Нажмите Play
3. Вы должны увидеть сообщения:
   ```
   Apple Apple 1 initialized at position (3, 2, 0)
   Apple Apple 2 initialized at position (-10, 6, 0)
   ...
   ```

**Если сообщений нет:**
- Скрипт AppleCollectible не прикреплен к яблокам
- Проверьте, что файлы Assets/AppleCollectible.cs и Assets/AppleCollectible.cs.meta существуют

### Шаг 3: Попробуйте собрать яблоко
1. Используйте WASD или стрелки для движения
2. Пробел для прыжка
3. Подойдите к любому яблоку и коснитесь его

**Ожидаемое поведение:**
- Игрок ПРОХОДИТ СКВОЗЬ яблоко (это правильно - у яблока trigger collider)
- Яблоко начинает плавно исчезать (fade out 0.5 секунды)
- Счётчик очков в правом верхнем углу увеличивается на 1
- В консоли появляются сообщения:
  ```
  Apple Apple X triggered by: Player, tag: Player
  Apple Apple X collected by Player!
  ```

### Шаг 4: Проверьте победный экран
1. Соберите все 20 яблок
2. После сбора 20-го яблока должен появиться экран победы

**ВАЖНО:** Экран победы нужно настроить вручную!

## Настройка экрана победы (Victory Screen)

### Автоматическая настройка (рекомендуется):
1. В Unity меню выберите: **Tools → Setup Victory Screen**
2. Нажмите кнопку "Setup Victory Screen"
3. Готово!

### Ручная настройка:
Следуйте инструкциям в файле `VICTORY_SCREEN_SETUP.md`

## Диагностика проблем

### Проблема: Яблоки не собираются (ничего не происходит)

#### Проверка 1: Консоль Unity
Откройте Console и проверьте, есть ли сообщения при касании яблока:
- **Если есть "Apple X triggered by: Player"** → Столкновение обнаружено ✓
- **Если есть "Apple X collected by Player!"** → Коллекция работает ✓
- **Если сообщений нет** → Проблема со столкновением, см. ниже

#### Проверка 2: Player имеет правильный Tag
1. Выберите Player в Hierarchy
2. В Inspector вверху проверьте Tag
3. Должно быть: **Tag: Player**
4. Если нет, измените на "Player"

#### Проверка 3: Player имеет Rigidbody2D
1. Выберите Player в Hierarchy
2. В Inspector должен быть компонент **Rigidbody2D**
3. Body Type: **Dynamic** (не Kinematic, не Static)
4. Simulated: **✓** (галочка стоит)

#### Проверка 4: Player имеет Collider2D
1. Выберите Player в Hierarchy
2. В Inspector должен быть компонент **Box Collider 2D** или другой Collider2D
3. Is Trigger: **НЕ** должно быть отмечено (галочка НЕ стоит)

#### Проверка 5: Яблоки имеют trigger colliders
1. Выберите любое яблоко в Hierarchy (Apple 1, Apple 2, и т.д.)
2. В Inspector должен быть **Box Collider 2D**
3. Is Trigger: **✓** (галочка ДОЛЖНА стоять)
4. Если галочки нет, поставьте её для всех яблок

#### Проверка 6: Яблоки имеют AppleCollectible script
1. Выберите любое яблоко в Hierarchy
2. В Inspector должен быть компонент **Apple Collectible (Script)**
3. Если его нет:
   - Нажмите "Add Component"
   - Найдите "Apple Collectible"
   - Добавьте его
4. Повторите для всех яблок

#### Проверка 7: Layers правильно настроены
1. Edit → Project Settings → Physics 2D
2. Найдите "Layer Collision Matrix"
3. Проверьте, что слой Default (Player) может сталкиваться со слоем Apple
4. Должна стоять галочка на пересечении этих слоёв

#### Проверка 8: Queries Hit Triggers включено
1. Edit → Project Settings → Physics 2D
2. Найдите "Queries Hit Triggers"
3. Должна стоять галочка ✓

### Проблема: Яблоки собираются, но счёт не увеличивается

1. Найдите объект "ScoreManager" в Hierarchy
2. Проверьте, что компонент ScoreManager прикреплён
3. В компоненте ScoreManager:
   - Score Text: должна быть ссылка на текстовый объект "ScoreCounter"
   - Total Apples: должно быть 20

### Проблема: Собрали все яблоки, но экран победы не появляется

1. Настройте Victory Screen (см. выше раздел "Настройка экрана победы")
2. Проверьте в ScoreManager:
   - Total Apples: должно быть 20
   - Victory Screen: должна быть ссылка на объект VictoryScreen

## Отключение отладочных сообщений

После того как убедитесь, что всё работает, можете отключить debug логи:

1. Откройте Assets/AppleCollectible.cs
2. Закомментируйте или удалите строки с `Debug.Log` и `Debug.LogError`
3. Сохраните файл

## Контрольный список финальной проверки

- [ ] Яблоки расположены далеко друг от друга (минимум 2 единицы)
- [ ] При касании яблока игрок проходит сквозь него
- [ ] Яблоко плавно исчезает за 0.5 секунды
- [ ] Счётчик очков увеличивается на 1 за каждое яблоко
- [ ] После сбора всех 20 яблок появляется чёрный экран
- [ ] На чёрном экране есть красная надпись: "Вы собрали все яблоки. Теперь вы довольны?"

## Известные ограничения

- Victory Screen нужно настроить вручную в Unity Editor
- Отладочные сообщения будут показываться в консоли (можно отключить позже)
- Эффект fade-out яблок можно настроить изменяя параметр fadeOutTime в Inspector
